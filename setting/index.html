<!DOCTYPE html>
<html lang = "ja">
<html>
<head>
<meta charset = "utf8">
<title>Test</title>
<script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
</head>
<body>
    <div id="wifiset">
        <h3>wifi設定</h3>
    </div>
    <div id="settitle">
        <h4>タイトル設定</h4>
        <input type=text>
    </div>
    <button id="settitle">タイトルを設定</button>
    <script>
        $(function(){
            var url="http://192.168.1.78:5000"
            $.ajax({
                type:"get",
                url: url+"/list", 
                dataType:"json",
            }).done(function(data){
                var l = Object.keys(data).length;
                for(let i=0;i<l;i++){
                    var ssid=data[i].SSID;
                    var power=data[i].POWER;
                    $(
                        "<div class='wifi' id='"+String(i)+"'>"+
                        "<img src='./img/wifi"+power+".png'>" + ssid+
                        "<hr>"+
                        "</div>"
                    ).appendTo("div#wifiset")
                }
            });
            $(document).on("click",".wifi",function(){
                console.log("hoge");
                var id=$(this).attr("id");
                var pass=window.prompt("wifiのpasswordを入力してください");
                if (pass.length !== 0){
                    alert("wifiに接続します");
                    $.ajax({
                        type:"post",
                        url:url+"/connect",
                        dataType:"json",
                        data:{"id":String(id),"pass":pass}
                    })
                }
            });
            $("button#settitle").click(function(){
                var title = $("input").val();
                $.ajax({
                    type:"post",
                    url: url+"/settitle",
                    dataType:"json",
                    data:{"title":title}
                })
                alert("titleを"+title+"に設定しました");
            })
        });
    </script>
</body>
</html>

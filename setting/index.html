<!DOCTYPE html>
<html lang = "ja">
<html>
<head>
<meta charset = "utf8">
<title>Test</title>
<script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
</head>
<body>
    <div id="wifiset">
        <h3>wifi設定</h3>
    </div>
    <div id="settitle">
        <h4>タイトル設定</h4>
        <input type=text>
    </div>
    <button id="settitle">タイトルを設定</button>
    <script>
        $(function(){
            $.ajax({
                type:"get",
                url:"http://localhost:5000/list", 
                dataType:"json",
            }).done(function(data){
                var l = Object.keys(data).length;
                for(let i=0;i<l;i++){
                    var ssid=data[i].SSID;
                    var power=data[i].POWER;
                    $(
                        "<div class='wifi id='div"+String(i)+"'>"+
                        power + ssid+
                        "<button class='wifiset' id='"+String(i)+"'>connect</button>"+
                        "</div>"
                    ).appendTo("div#wifiset")
                }
            });
            $(document).on("click",".wifiset",function(){
                console.log("hoge");
                var id=$(this).attr("id");
                var pass=window.prompt("wifiのpasswordを入力してください");
                $.ajax({
                    type:"post",
                    url:"http://localhost:5000/connect",
                    dataType:"json",
                    data:{"id":String(id),"pass":pass}
                })
                alert("wifiに接続します");
            });
            $("button#settitle").click(function(){
                var title = $("input").val();
                $.ajax({
                    type:"post",
                    url:"http://localhost:5000/settitle",
                    dataType:"json",
                    data:{"title":title}
                })
                alert("titleを"+title+"に設定しました");
            })
        });
    </script>
</body>
</html>
